(function(t){"use strict";function e(t){return function(e,r){if("string"!=typeof e)o.extend(this[t],e);else{if(!r)return this[t][e];this[t][e]=r}}}var r,n,i,o,a,s=Array.prototype,u=s.slice,l=s.isArray,f=s.forEach,c=s.indexOf,h=t.document||{};r=function(){this.routes={},this.filters={}},"object"==typeof module&&"object"==typeof module.exports?module.exports=r:t.Doppelganger=r,r.prototype={create:function(t){for(var e in t)this["add"+o.capitolize(e)](t[e])},init:function(){a(t).on("statechange",function(){var e=History.getState();e.data&&e.data.controllerStateChange||t.trigger(e.data.destination,e.data.params)})},addRoutes:e("routes"),addRoute:e("routes"),getRoute:e("routes"),addFilters:e("filters"),addFilter:e("filters"),getFilter:e("filters"),navigate:function(){t.navigate=function(e,r){history.pushState?History.pushState({destination:e,params:r},h.title,t.helpers.routing.generate(e,r)):t.location=t.helpers.routing.generate(e,r)},t.helpers.filterManager.process()},trigger:function(e,r){t.helpers.filterManager.process({destination:e,params:r})},updateContent:function(e){var r=a(this.PAGE_CONTENT_SELECTOR);return r.children().not("."+t.UMFlashMessage.messageClass).remove(),r.append(e)}},r.util=o={capitolize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},extend:function(t){var e,r,n,i=u.call(arguments,1);for(r=0;i.length>r;r++)if(e=i[r])for(n in e)t[n]=e[n];return t},each:function(t,e,r){if(null!=t)if(f&&t.forEach===f)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,i=t.length;i>n;n++)if(e.call(r,t[n],n,t)===!1)return}else for(var o in t)if(t.hasOwnProperty(o)&&e(t[o],o,t)===!1)break},isArray:l||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&"[object Array]"==""+t||!1},indexOf:function(t,e){if(null==t)return-1;var r=0,n=t.length;if(c&&t.indexOf===c)return t.indexOf(e);for(;n>r;r++)if(t[r]===e)return r;return-1},map:function(t,e){var r=-1,n=t?t.length:0,i=Array("number"==typeof n?n:0);if(o.isArray(t))for(;n>++r;)i[r]=e(t[r],r,t);else o.each(t,function(t,n,o){i[++r]=e(t,n,o)});return i},$:h.querySelectorAll},a=o.$,r.Request=i=function(t){this.app=t},r.Request.prototype={setQueryParam:function(t,e){0===e.length?delete this.query[t]:this.query[t]=e},getQuery:function(){return this.query},setQuery:function(t){this.query=t},buildQueryString:function(){var t="";return a.each(this.getQuery(),function(e,r){t+=encodeURIComponent(e)+"="+encodeURIComponent(r),t+="&"}),t.length?"?"+t.slice(0,-1):t}};var p=0;r.FilterManager=function(){this.filters=[]},r.FilterManager.prototype={add:function(t){this.filters.push(t)},remove:function(t){var e=o.indexOf(t,this.filters);e!==!1&&(p>e&&(p-=1),this.filters.splice(e,1))},process:function(t){for(p=0;this.filters.length>p;p++)t=this.filters[p](t)}},r.Filters={},r.Filter=n=function(t,e){this.name=t,this.filter=e},n.prototype={apply:function(t,e){this.filter.call(t,e)}},r.Filters.LocationFilter=new n("Location",function(e){var r;e.location=r=t.location,r&&(e.search=t.location.search,e.pathName=t.location.pathname)}),r.Filters.QueryStringFilter=new n("QueryString",function(t){var e=t.search,r=e.slice(1).split("&"),n={};""!==e&&a.each(r,function(t,e){var r=e.split("=");n[r[0]]=r[1]}),t.setQuery(n)}),r.Filters.RouterFilter=new n("Router",function(t){function e(t){if(t){var e=a(h);o.each(t,function(t,r){var n=r.substr(0,r.indexOf(" ")),i=r.substr(n.length+1);e.on(n,i,t)})}}e({"click a":function(){console.log(t)}})})})(this);